INFO:__main__:============================ read file 16.txt, now total_tx_num reaches 100, write log to logs/tx_log_16.txt =====================
ERROR:__main__:Errored: 1 retry happened in running tx: PaymentTxParams, ErrorMsg:
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=301bbc2f key=/Table/65/1/7/1 pri=0.00027404 epo=0 ts=1635780683.256540000,3 min=1635780676.694674000,0 seq=1} lock=true stat=ABORTED rts=1635780683.256540000,3 wto=false gul=1635780677.194674000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted
 ], Traceback:
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 64, in run_tx
    res = operation(m_conn)
  File "cockroachDB_driver.py", line 108, in <lambda>
    lambda l_conn: m_tx_ins.payment_transaction(l_conn, m_params))
  File "/Users/rootuserxing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 219, in payment_transaction
    (payment_amount, c_w_id))
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=301bbc2f key=/Table/65/1/7/1 pri=0.00027404 epo=0 ts=1635780683.256540000,3 min=1635780676.694674000,0 seq=1} lock=true stat=ABORTED rts=1635780683.256540000,3 wto=false gul=1635780677.194674000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted

 ]
INFO:__main__:Running Tx PaymentTxParams successful at the 2 time retry
INFO:__main__:============================ read file 16.txt, now total_tx_num reaches 200, write log to logs/tx_log_16.txt =====================
INFO:__main__:============================ read file 16.txt, now total_tx_num reaches 300, write log to logs/tx_log_16.txt =====================
INFO:__main__:============================ read file 16.txt, now total_tx_num reaches 400, write log to logs/tx_log_16.txt =====================
INFO:__main__:============================ read file 16.txt, now total_tx_num reaches 500, write log to logs/tx_log_16.txt =====================
INFO:__main__:============================ using file /opt/project_files_4/xact_files_A/16.txt=====================
INFO:__main__:=======> required_tx_types is:
INFO:__main__:{'PaymentTxParams': 102, 'NewOrderTxParams': 196, 'DeliveryTxParams': 99, 'RelCustomerTxParams': 17, 'PopItemTxParams': 26, 'TopBalanceTxParams': 30, 'OrderStatusTxParams': 21, 'StockLevelTxParams': 20}
INFO:__main__:=======> succeed_tx_types is:
INFO:__main__:{'PaymentTxParams': 102, 'NewOrderTxParams': 196, 'DeliveryTxParams': 99, 'RelCustomerTxParams': 17, 'PopItemTxParams': 26, 'TopBalanceTxParams': 30, 'OrderStatusTxParams': 21, 'StockLevelTxParams': 20}
INFO:__main__:=======> tx num percentages is:
INFO:__main__:{'PaymentTxParams': '19.96%', 'NewOrderTxParams': '38.35%', 'DeliveryTxParams': '19.37%', 'RelCustomerTxParams': '3.326%', 'PopItemTxParams': '5.088%', 'TopBalanceTxParams': '5.870%', 'OrderStatusTxParams': '4.109%', 'StockLevelTxParams': '3.913%'}
INFO:__main__:=======> tx_time_range [min-max] is :
INFO:__main__:{'PaymentTxParams': [0.2705800533294678, 14.239609003067017], 'NewOrderTxParams': [0.2668581008911133, 17.35351300239563], 'DeliveryTxParams': [0.025475740432739258, 5.721062421798706], 'RelCustomerTxParams': [14.364274024963379, 45.88604497909546], 'PopItemTxParams': [0.03360414505004883, 1.2234129905700684], 'TopBalanceTxParams': [0.0024700164794921875, 0.16456222534179688], 'OrderStatusTxParams': [0.006851911544799805, 0.3207409381866455], 'StockLevelTxParams': [0.02999091148376465, 0.5420558452606201]}
INFO:__main__:=======> tx_time middle time is :
INFO:__main__:{'PaymentTxParams': 0.5259830951690674, 'NewOrderTxParams': 3.0768229961395264, 'DeliveryTxParams': 0.307873010635376, 'RelCustomerTxParams': 22.236891984939575, 'PopItemTxParams': 0.4637889862060547, 'TopBalanceTxParams': 0.011483907699584961, 'OrderStatusTxParams': 0.03333306312561035, 'StockLevelTxParams': 0.19273686408996582}
INFO:__main__:=======> tx_time average time is :
INFO:__main__:{'PaymentTxParams': 1.111897073540033, 'NewOrderTxParams': 4.060844074706642, 'DeliveryTxParams': 0.7783542450028237, 'RelCustomerTxParams': 27.28534977576312, 'PopItemTxParams': 0.4001266681230985, 'TopBalanceTxParams': 0.024606839815775553, 'OrderStatusTxParams': 0.07023946444193523, 'StockLevelTxParams': 0.2153361678123474}
INFO:__main__:=======> tx time percentage is :
INFO:__main__:{'PaymentTxParams': '7.662%', 'NewOrderTxParams': '53.77%', 'DeliveryTxParams': '5.206%', 'RelCustomerTxParams': '31.33%', 'PopItemTxParams': '0.702%', 'TopBalanceTxParams': '0.049%', 'OrderStatusTxParams': '0.099%', 'StockLevelTxParams': '0.290%'}
INFO:__main__:============> full tx time used
INFO:__main__:{'PaymentTxParams': [0.2705800533294678, 0.2805452346801758, 0.30006980895996094, 0.31119704246520996, 0.3209059238433838, 0.32466602325439453, 0.33666110038757324, 0.339522123336792, 0.34305882453918457, 0.3544018268585205, 0.36414289474487305, 0.36823296546936035, 0.36853790283203125, 0.37526369094848633, 0.3880798816680908, 0.3883018493652344, 0.3883211612701416, 0.39014101028442383, 0.3932790756225586, 0.39346885681152344, 0.3958721160888672, 0.4025402069091797, 0.4052622318267822, 0.40562987327575684, 0.4078390598297119, 0.4144587516784668, 0.4170379638671875, 0.4180588722229004, 0.4207737445831299, 0.42940282821655273, 0.44061732292175293, 0.44784116744995117, 0.448944091796875, 0.45406079292297363, 0.4553549289703369, 0.4558548927307129, 0.45816898345947266, 0.4585859775543213, 0.4604320526123047, 0.46431589126586914, 0.46532106399536133, 0.47182631492614746, 0.48168277740478516, 0.4913296699523926, 0.4980788230895996, 0.49823498725891113, 0.4995851516723633, 0.5047180652618408, 0.5084710121154785, 0.5123260021209717, 0.5177907943725586, 0.5259830951690674, 0.5534148216247559, 0.5630002021789551, 0.5653390884399414, 0.5787417888641357, 0.5870108604431152, 0.5938589572906494, 0.5981502532958984, 0.6002287864685059, 0.6033971309661865, 0.6175088882446289, 0.6182370185852051, 0.6295478343963623, 0.6368920803070068, 0.637322187423706, 0.6467106342315674, 0.6614608764648438, 0.6828799247741699, 0.7076070308685303, 0.7664968967437744, 0.7974851131439209, 0.832827091217041, 0.8605568408966064, 0.8846249580383301, 0.895587682723999, 1.0683300495147705, 1.0792560577392578, 1.2081637382507324, 1.2813458442687988, 1.346545934677124, 1.3809809684753418, 1.4002680778503418, 1.598870038986206, 1.6547648906707764, 1.6677799224853516, 1.7375469207763672, 1.9400241374969482, 1.9408891201019287, 1.9518492221832275, 2.057561159133911, 2.245004177093506, 2.2673048973083496, 2.3419270515441895, 2.5434629917144775, 2.879984140396118, 3.1041510105133057, 3.1281819343566895, 4.8734540939331055, 7.26531720161438, 7.456265211105347, 14.239609003067017], 'NewOrderTxParams': [0.2668581008911133, 0.33286476135253906, 0.3404068946838379, 0.3644599914550781, 0.3990023136138916, 0.42451977729797363, 0.46142077445983887, 0.47653675079345703, 0.48303890228271484, 0.4834439754486084, 0.5243239402770996, 0.5286660194396973, 0.5394339561462402, 0.5571231842041016, 0.574307918548584, 0.5769710540771484, 0.6159348487854004, 0.6291592121124268, 0.6339530944824219, 0.6721220016479492, 0.6771030426025391, 0.6991720199584961, 0.7038111686706543, 0.7159600257873535, 0.7312309741973877, 0.7635068893432617, 0.7688922882080078, 0.7760241031646729, 0.7784028053283691, 0.7938249111175537, 0.799130916595459, 0.8377029895782471, 0.8666350841522217, 0.8897957801818848, 0.9075901508331299, 0.9085090160369873, 0.9341707229614258, 0.9395930767059326, 0.9427800178527832, 0.9523870944976807, 0.9670591354370117, 0.9880161285400391, 1.0015077590942383, 1.0110859870910645, 1.0190670490264893, 1.058413028717041, 1.059194803237915, 1.0873239040374756, 1.1016600131988525, 1.163182020187378, 1.1734580993652344, 1.2426371574401855, 1.2938201427459717, 1.2965917587280273, 1.3198459148406982, 1.3383560180664062, 1.3510138988494873, 1.3590400218963623, 1.3640830516815186, 1.382465124130249, 1.4480211734771729, 1.4499762058258057, 1.585954189300537, 1.5934810638427734, 1.6313037872314453, 1.665201187133789, 1.8062708377838135, 1.8171138763427734, 1.8830897808074951, 1.9796619415283203, 1.9991552829742432, 2.0103538036346436, 2.0159990787506104, 2.0479471683502197, 2.054656982421875, 2.0634167194366455, 2.0690009593963623, 2.078535795211792, 2.093555212020874, 2.1308560371398926, 2.166266918182373, 2.1813700199127197, 2.2010629177093506, 2.2215328216552734, 2.242772102355957, 2.3043508529663086, 2.32515811920166, 2.404007911682129, 2.5474231243133545, 2.5691871643066406, 2.7931861877441406, 2.8353378772735596, 2.867891788482666, 2.882768154144287, 2.94336199760437, 3.0032920837402344, 3.025033950805664, 3.065063953399658, 3.0768229961395264, 3.189305067062378, 3.198061943054199, 3.2290990352630615, 3.2579309940338135, 3.2685821056365967, 3.34394907951355, 3.4636130332946777, 3.4781923294067383, 3.5252301692962646, 3.6474881172180176, 3.851194143295288, 3.933825969696045, 4.035624027252197, 4.05503511428833, 4.074723720550537, 4.080560207366943, 4.180419921875, 4.294517993927002, 4.306888103485107, 4.41471529006958, 4.463449001312256, 4.9178831577301025, 4.9366490840911865, 4.977268934249878, 5.071858167648315, 5.102581977844238, 5.144007921218872, 5.1986188888549805, 5.2393059730529785, 5.312427997589111, 5.334492921829224, 5.335930109024048, 5.372545003890991, 5.44353985786438, 5.80818510055542, 5.891269207000732, 5.932219743728638, 5.964781045913696, 6.047491073608398, 6.052519083023071, 6.063122034072876, 6.1287150382995605, 6.131383895874023, 6.2238829135894775, 6.230607748031616, 6.2334980964660645, 6.288655042648315, 6.411774396896362, 6.816665887832642, 6.866943120956421, 6.9457738399505615, 7.033211946487427, 7.035564661026001, 7.0657689571380615, 7.0776050090789795, 7.124511957168579, 7.184214115142822, 7.190361738204956, 7.192265272140503, 7.2327258586883545, 7.314877033233643, 7.32337212562561, 7.324095249176025, 7.390351057052612, 7.42262077331543, 7.917497158050537, 7.952657222747803, 7.9702558517456055, 8.045018911361694, 8.045825958251953, 8.054826974868774, 8.117072105407715, 8.123088121414185, 8.228864908218384, 8.29619312286377, 8.306979894638062, 8.407668352127075, 8.440826177597046, 8.5563063621521, 8.73476505279541, 8.9461088180542, 9.072245836257935, 9.110965967178345, 9.204513788223267, 9.373217105865479, 9.453060865402222, 9.488004922866821, 9.774694204330444, 9.994990825653076, 10.073903799057007, 10.750557899475098, 11.044987201690674, 11.066381216049194, 11.251626968383789, 12.125990152359009, 14.08624792098999, 17.35351300239563], 'DeliveryTxParams': [0.025475740432739258, 0.027741432189941406, 0.027940034866333008, 0.03254580497741699, 0.03638768196105957, 0.03647041320800781, 0.03812098503112793, 0.04347801208496094, 0.04388427734375, 0.046944618225097656, 0.05060291290283203, 0.06870102882385254, 0.07105469703674316, 0.07304883003234863, 0.07561182975769043, 0.07786345481872559, 0.07883000373840332, 0.07916450500488281, 0.07924365997314453, 0.08052492141723633, 0.08428001403808594, 0.08633708953857422, 0.08960533142089844, 0.10419774055480957, 0.11383700370788574, 0.11669468879699707, 0.11905288696289062, 0.12161707878112793, 0.12475705146789551, 0.12966609001159668, 0.12987446784973145, 0.12990450859069824, 0.13960886001586914, 0.16166472434997559, 0.18355202674865723, 0.18503785133361816, 0.1861112117767334, 0.19282770156860352, 0.22565126419067383, 0.2297656536102295, 0.23382234573364258, 0.24112248420715332, 0.2426919937133789, 0.2463984489440918, 0.2654731273651123, 0.26781606674194336, 0.28221631050109863, 0.282498836517334, 0.29958438873291016, 0.307873010635376, 0.3118317127227783, 0.3171415328979492, 0.3201911449432373, 0.3428199291229248, 0.3533749580383301, 0.37194204330444336, 0.3790411949157715, 0.40326571464538574, 0.703474760055542, 0.7398920059204102, 0.747020959854126, 0.7981882095336914, 0.8012399673461914, 0.9140305519104004, 0.9257237911224365, 0.9683501720428467, 0.9719150066375732, 0.9759676456451416, 0.9844849109649658, 1.0780510902404785, 1.0799312591552734, 1.1017472743988037, 1.1262331008911133, 1.1291561126708984, 1.2297887802124023, 1.2626080513000488, 1.289067029953003, 1.3405389785766602, 1.3459503650665283, 1.3625812530517578, 1.406313180923462, 1.414984941482544, 1.4811036586761475, 1.5779643058776855, 1.5791583061218262, 1.6044518947601318, 1.6638438701629639, 1.8802268505096436, 2.02407169342041, 2.252675771713257, 2.4302468299865723, 2.4637537002563477, 2.5008182525634766, 2.5350348949432373, 2.5654079914093018, 2.690321683883667, 3.453810453414917, 3.519094944000244, 5.721062421798706], 'RelCustomerTxParams': [14.364274024963379, 14.442543983459473, 14.955106973648071, 15.281885862350464, 16.857178926467896, 18.10120129585266, 19.23420000076294, 20.728567838668823, 22.236891984939575, 27.778210163116455, 34.87246632575989, 36.873406171798706, 36.98073077201843, 38.49791693687439, 41.130465030670166, 45.629854917526245, 45.88604497909546], 'PopItemTxParams': [0.03360414505004883, 0.05021500587463379, 0.0677649974822998, 0.06887483596801758, 0.07278084754943848, 0.08159470558166504, 0.09429287910461426, 0.16452574729919434, 0.2175149917602539, 0.25342893600463867, 0.27606701850891113, 0.2862379550933838, 0.33810997009277344, 0.4637889862060547, 0.47565793991088867, 0.4963090419769287, 0.4990088939666748, 0.5037498474121094, 0.5149779319763184, 0.562669038772583, 0.570976972579956, 0.6503658294677734, 0.7420768737792969, 0.8058459758758545, 0.8894410133361816, 1.2234129905700684], 'TopBalanceTxParams': [0.0024700164794921875, 0.0037491321563720703, 0.003989458084106445, 0.004229307174682617, 0.0045778751373291016, 0.004907131195068359, 0.005257844924926758, 0.005883932113647461, 0.006451845169067383, 0.006476163864135742, 0.007169008255004883, 0.007238864898681641, 0.009861946105957031, 0.010043859481811523, 0.010565996170043945, 0.011483907699584961, 0.011561870574951172, 0.012725114822387695, 0.012744903564453125, 0.013319015502929688, 0.01378321647644043, 0.014138221740722656, 0.01603388786315918, 0.029536962509155273, 0.030888080596923828, 0.03686022758483887, 0.05054211616516113, 0.09351706504821777, 0.1336359977722168, 0.16456222534179688], 'OrderStatusTxParams': [0.006851911544799805, 0.0073931217193603516, 0.008899211883544922, 0.01083993911743164, 0.016396045684814453, 0.017168283462524414, 0.01856517791748047, 0.022171974182128906, 0.02472710609436035, 0.0320582389831543, 0.03333306312561035, 0.04250502586364746, 0.051711082458496094, 0.052353858947753906, 0.0698850154876709, 0.07176327705383301, 0.08779692649841309, 0.18126177787780762, 0.1880507469177246, 0.2105560302734375, 0.3207409381866455], 'StockLevelTxParams': [0.02999091148376465, 0.08763480186462402, 0.09198212623596191, 0.11164188385009766, 0.11763405799865723, 0.11838793754577637, 0.1288599967956543, 0.15592503547668457, 0.16604876518249512, 0.17505908012390137, 0.19273686408996582, 0.23705816268920898, 0.24017691612243652, 0.24866294860839844, 0.2542910575866699, 0.2647087574005127, 0.3391611576080322, 0.35219907760620117, 0.45250797271728516, 0.5420558452606201]}
INFO:__main__:============================ total time used: 1480.1481440067291 second =====================
