ERROR:__main__:Errored: 1 retry happened in running tx: DeliveryTxParams-update1, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=23b76da3 key=/Table/58/2/1/1/2295 pri=0.00963304 epo=0 ts=1635832165.513264527,0 min=1635832165.513264527,0 seq=160} lock=true stat=PENDING rts=1635832165.513264527,0 wto=false gul=1635832166.013264527,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 64, in run_tx
    res = operation(m_conn)
  File "cockroachDB_driver.py", line 188, in <lambda>
    l_conn, w_id, carrier_id, id_tuples))
  File "/home/stuproj/cs4224p/temp/tasks/txs/tx_workloadA.py", line 335, in delivery_update_transaction1
    m_conn.commit()
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=23b76da3 key=/Table/58/2/1/1/2295 pri=0.00963304 epo=0 ts=1635832165.513264527,0 min=1635832165.513264527,0 seq=160} lock=true stat=PENDING rts=1635832165.513264527,0 wto=false gul=1635832166.013264527,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn

 ]
INFO:__main__:Running Tx DeliveryTxParams-update1 successful at the 2 time retry
INFO:__main__:============================ read file 27.txt, now total_tx_num reaches 100, write log to logs/tx_log_27.txt =====================
ERROR:__main__:Errored: 1 retry happened in running tx: DeliveryTxParams-update4, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=a5482597 key=/Table/57/1/2/1/882/0 pri=0.00791098 epo=0 ts=1635832213.705398068,1 min=1635832213.614614503,0 seq=11} lock=true stat=PENDING rts=1635832213.705398068,1 wto=false gul=1635832214.114614503,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 64, in run_tx
    res = operation(m_conn)
  File "cockroachDB_driver.py", line 196, in <lambda>
    l_conn, cid_map, sum_map))
  File "/home/stuproj/cs4224p/temp/tasks/txs/tx_workloadA.py", line 426, in delivery_update_transaction4
    m_conn.commit()
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=a5482597 key=/Table/57/1/2/1/882/0 pri=0.00791098 epo=0 ts=1635832213.705398068,1 min=1635832213.614614503,0 seq=11} lock=true stat=PENDING rts=1635832213.705398068,1 wto=false gul=1635832214.114614503,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn

 ]
INFO:__main__:Running Tx DeliveryTxParams-update4 successful at the 2 time retry
INFO:__main__:============================ read file 27.txt, now total_tx_num reaches 200, write log to logs/tx_log_27.txt =====================
INFO:__main__:============================ read file 27.txt, now total_tx_num reaches 300, write log to logs/tx_log_27.txt =====================
INFO:__main__:============================ read file 27.txt, now total_tx_num reaches 400, write log to logs/tx_log_27.txt =====================
INFO:__main__:============================ read file 27.txt, now total_tx_num reaches 500, write log to logs/tx_log_27.txt =====================
INFO:__main__:============================ using file /home/stuproj/cs4224p/temp/tasks/project_files_4/xact_files_A/27.txt=====================
INFO:__main__:connect to postgresql://naili:@xcnd57:27257/cs5424db, Read file /home/stuproj/cs4224p/temp/tasks/project_files_4/xact_files_A/27.txt and run workload A
INFO:__main__:=======> required_tx_types is: 
INFO:__main__:{'DeliveryTxParams': 105, 'PaymentTxParams': 98, 'NewOrderTxParams': 215, 'PopItemTxParams': 22, 'TopBalanceTxParams': 27, 'OrderStatusTxParams': 23, 'RelCustomerTxParams': 7, 'StockLevelTxParams': 14}
INFO:__main__:=======> succeed_tx_types is: 
INFO:__main__:{'DeliveryTxParams': 105, 'PaymentTxParams': 98, 'NewOrderTxParams': 215, 'PopItemTxParams': 22, 'TopBalanceTxParams': 27, 'OrderStatusTxParams': 23, 'RelCustomerTxParams': 7, 'StockLevelTxParams': 14}
INFO:__main__:=======> tx num percentages is: 
INFO:__main__:{'DeliveryTxParams': '20.54%', 'PaymentTxParams': '19.17%', 'NewOrderTxParams': '42.07%', 'PopItemTxParams': '4.305%', 'TopBalanceTxParams': '5.283%', 'OrderStatusTxParams': '4.500%', 'RelCustomerTxParams': '1.369%', 'StockLevelTxParams': '2.739%'}
INFO:__main__:=======> tx_time_range [min-max] is : 
INFO:__main__:{'DeliveryTxParams': [0.08087372779846191, 11.078215837478638], 'PaymentTxParams': [0.007732391357421875, 5.527495622634888], 'NewOrderTxParams': [0.04474329948425293, 6.435408592224121], 'PopItemTxParams': [0.07027387619018555, 0.8906877040863037], 'TopBalanceTxParams': [0.00359344482421875, 0.03266501426696777], 'OrderStatusTxParams': [0.01051187515258789, 0.1237795352935791], 'RelCustomerTxParams': [4.729060649871826, 30.03121852874756], 'StockLevelTxParams': [0.03783607482910156, 0.47180938720703125]}
INFO:__main__:=======> tx_time middle time is : 
INFO:__main__:{'DeliveryTxParams': 0.39024901390075684, 'PaymentTxParams': 0.03238558769226074, 'NewOrderTxParams': 0.30634355545043945, 'PopItemTxParams': 0.5320830345153809, 'TopBalanceTxParams': 0.0067234039306640625, 'OrderStatusTxParams': 0.0398714542388916, 'RelCustomerTxParams': 14.233669996261597, 'StockLevelTxParams': 0.17403125762939453}
INFO:__main__:=======> tx_time average time is : 
INFO:__main__:{'DeliveryTxParams': 0.5102573871612549, 'PaymentTxParams': 0.27409909452710834, 'NewOrderTxParams': 0.8740176899488582, 'PopItemTxParams': 0.44453447515314276, 'TopBalanceTxParams': 0.008157270926016348, 'OrderStatusTxParams': 0.04073303678761358, 'RelCustomerTxParams': 15.218886954443795, 'StockLevelTxParams': 0.16443354742867605}
INFO:__main__:=======> tx time percentage is : 
INFO:__main__:{'DeliveryTxParams': '13.77%', 'PaymentTxParams': '6.906%', 'NewOrderTxParams': '48.31%', 'PopItemTxParams': '2.514%', 'TopBalanceTxParams': '0.056%', 'OrderStatusTxParams': '0.240%', 'RelCustomerTxParams': '27.38%', 'StockLevelTxParams': '0.591%'}
INFO:__main__:============> full tx time used 
INFO:__main__:{'DeliveryTxParams': [0.08087372779846191, 0.08201408386230469, 0.08391189575195312, 0.092742919921875, 0.10128474235534668, 0.1021578311920166, 0.10405158996582031, 0.10527563095092773, 0.10894465446472168, 0.11402010917663574, 0.11762547492980957, 0.12081146240234375, 0.12192535400390625, 0.12230038642883301, 0.12364506721496582, 0.12668967247009277, 0.13438725471496582, 0.13994503021240234, 0.1466677188873291, 0.147003173828125, 0.1487441062927246, 0.14914441108703613, 0.1494770050048828, 0.14976739883422852, 0.15308737754821777, 0.1532459259033203, 0.15796995162963867, 0.15814805030822754, 0.16891145706176758, 0.17430615425109863, 0.21559548377990723, 0.2357654571533203, 0.2436075210571289, 0.2442920207977295, 0.2552788257598877, 0.259660005569458, 0.26752567291259766, 0.30576133728027344, 0.31528806686401367, 0.3307361602783203, 0.33081746101379395, 0.33264613151550293, 0.3369410037994385, 0.3427414894104004, 0.34824252128601074, 0.35512828826904297, 0.3588993549346924, 0.3630390167236328, 0.3653585910797119, 0.369854211807251, 0.38318967819213867, 0.3844425678253174, 0.39024901390075684, 0.394878625869751, 0.3953511714935303, 0.39717912673950195, 0.3971834182739258, 0.4048788547515869, 0.40629029273986816, 0.41115832328796387, 0.41556453704833984, 0.420269250869751, 0.4248628616333008, 0.427581787109375, 0.4276292324066162, 0.4420053958892822, 0.4420750141143799, 0.4449958801269531, 0.4570276737213135, 0.46129775047302246, 0.4762556552886963, 0.48165082931518555, 0.48329663276672363, 0.48989057540893555, 0.4953165054321289, 0.500784158706665, 0.5014562606811523, 0.5040805339813232, 0.516765832901001, 0.5170149803161621, 0.5194985866546631, 0.5216717720031738, 0.529320478439331, 0.5293481349945068, 0.5320801734924316, 0.5362210273742676, 0.5373694896697998, 0.5536296367645264, 0.5587019920349121, 0.5637507438659668, 0.5892202854156494, 0.5913052558898926, 0.6038973331451416, 0.6057369709014893, 0.621124267578125, 0.6215219497680664, 0.6582193374633789, 0.6604831218719482, 0.7144615650177002, 0.7184126377105713, 0.7218954563140869, 0.9043779373168945, 1.0434725284576416, 4.752208471298218, 11.078215837478638], 'PaymentTxParams': [0.007732391357421875, 0.008059263229370117, 0.008283615112304688, 0.008970260620117188, 0.009304523468017578, 0.009637117385864258, 0.010327339172363281, 0.010486602783203125, 0.010978937149047852, 0.011313676834106445, 0.01188516616821289, 0.011894464492797852, 0.012089252471923828, 0.012183666229248047, 0.012655019760131836, 0.01275491714477539, 0.015278339385986328, 0.015733718872070312, 0.015895366668701172, 0.01632857322692871, 0.01663064956665039, 0.0168607234954834, 0.017384767532348633, 0.017601966857910156, 0.018039703369140625, 0.01889967918395996, 0.021919727325439453, 0.022608518600463867, 0.023039817810058594, 0.023305177688598633, 0.023461341857910156, 0.023591279983520508, 0.024226665496826172, 0.024277210235595703, 0.025238752365112305, 0.02555990219116211, 0.025835275650024414, 0.026442527770996094, 0.02649712562561035, 0.027342557907104492, 0.028395414352416992, 0.02842092514038086, 0.0291748046875, 0.02971625328063965, 0.02996826171875, 0.030324935913085938, 0.030652523040771484, 0.030950546264648438, 0.03104424476623535, 0.03238558769226074, 0.03257322311401367, 0.032653093338012695, 0.03273463249206543, 0.03422999382019043, 0.03460979461669922, 0.03507566452026367, 0.035288333892822266, 0.03540945053100586, 0.035841941833496094, 0.03630661964416504, 0.03634309768676758, 0.036437273025512695, 0.03778481483459473, 0.03867793083190918, 0.04171133041381836, 0.04340481758117676, 0.043999671936035156, 0.04500007629394531, 0.046648502349853516, 0.0473628044128418, 0.04816937446594238, 0.04817342758178711, 0.04880857467651367, 0.057065486907958984, 0.05800127983093262, 0.0666193962097168, 0.07009100914001465, 0.07120013236999512, 0.07618379592895508, 0.07642722129821777, 0.0773015022277832, 0.0862741470336914, 0.09668803215026855, 0.10800981521606445, 0.12457513809204102, 0.13792181015014648, 0.3209230899810791, 0.34218335151672363, 0.6481668949127197, 0.6549930572509766, 0.6909878253936768, 0.6915490627288818, 1.2090387344360352, 1.4751052856445312, 2.916536569595337, 4.402730703353882, 4.986808776855469, 5.527495622634888], 'NewOrderTxParams': [0.04474329948425293, 0.05237293243408203, 0.057830810546875, 0.06047701835632324, 0.06155037879943848, 0.0640726089477539, 0.06911826133728027, 0.07361841201782227, 0.08021903038024902, 0.08449935913085938, 0.08569049835205078, 0.08855891227722168, 0.09798979759216309, 0.1073141098022461, 0.1147613525390625, 0.11620688438415527, 0.11693739891052246, 0.11777019500732422, 0.11900639533996582, 0.11959028244018555, 0.1246333122253418, 0.12592601776123047, 0.12613439559936523, 0.1275014877319336, 0.13763856887817383, 0.13924837112426758, 0.1399247646331787, 0.14238190650939941, 0.14248156547546387, 0.14632678031921387, 0.14956235885620117, 0.1511704921722412, 0.1513981819152832, 0.15630483627319336, 0.158250093460083, 0.15854954719543457, 0.15962982177734375, 0.16205334663391113, 0.1639704704284668, 0.16473126411437988, 0.16698551177978516, 0.16796398162841797, 0.16918540000915527, 0.17077302932739258, 0.17479395866394043, 0.1753246784210205, 0.17652010917663574, 0.17803668975830078, 0.17944765090942383, 0.18270635604858398, 0.18366146087646484, 0.18419408798217773, 0.1849374771118164, 0.18947935104370117, 0.19013214111328125, 0.19143176078796387, 0.19217324256896973, 0.19281792640686035, 0.19294166564941406, 0.19509625434875488, 0.19640064239501953, 0.19776058197021484, 0.19829463958740234, 0.19912242889404297, 0.20109891891479492, 0.2048511505126953, 0.20506620407104492, 0.20635700225830078, 0.20640182495117188, 0.2073652744293213, 0.20874810218811035, 0.20878362655639648, 0.2099001407623291, 0.21050024032592773, 0.21255970001220703, 0.21538758277893066, 0.21544933319091797, 0.21660256385803223, 0.2186412811279297, 0.22218990325927734, 0.22328829765319824, 0.23049545288085938, 0.23180747032165527, 0.23634958267211914, 0.2388935089111328, 0.2397294044494629, 0.2400040626525879, 0.2405691146850586, 0.2543966770172119, 0.25557947158813477, 0.2578089237213135, 0.2591695785522461, 0.25939083099365234, 0.2600219249725342, 0.26314687728881836, 0.26882481575012207, 0.2725028991699219, 0.27448010444641113, 0.2761845588684082, 0.27642154693603516, 0.2819030284881592, 0.28734636306762695, 0.28990864753723145, 0.29261159896850586, 0.29422497749328613, 0.29698967933654785, 0.3031649589538574, 0.30634355545043945, 0.30902814865112305, 0.3186650276184082, 0.31995391845703125, 0.324390172958374, 0.3266334533691406, 0.3291175365447998, 0.33107876777648926, 0.34716224670410156, 0.3551442623138428, 0.3576059341430664, 0.36705565452575684, 0.36847519874572754, 0.3730921745300293, 0.40047740936279297, 0.4285902976989746, 0.43135809898376465, 0.4445154666900635, 0.4624063968658447, 0.4625966548919678, 0.4746696949005127, 0.5116746425628662, 0.5157337188720703, 0.543010950088501, 0.5776879787445068, 0.5946009159088135, 0.5972175598144531, 0.5991775989532471, 0.6369128227233887, 0.6571919918060303, 0.6904928684234619, 0.6936166286468506, 0.7450997829437256, 0.7560768127441406, 0.8150560855865479, 0.8948428630828857, 0.9047369956970215, 0.912816047668457, 0.935814380645752, 0.9598639011383057, 0.962409496307373, 1.0337438583374023, 1.0352404117584229, 1.0490927696228027, 1.0501492023468018, 1.0547842979431152, 1.0569074153900146, 1.1047966480255127, 1.1157925128936768, 1.1169440746307373, 1.1218442916870117, 1.1307432651519775, 1.1490819454193115, 1.1507048606872559, 1.1721022129058838, 1.194122552871704, 1.2137045860290527, 1.2306597232818604, 1.2780520915985107, 1.2802739143371582, 1.2935845851898193, 1.2992734909057617, 1.303999900817871, 1.3403301239013672, 1.353193759918213, 1.397052526473999, 1.4244599342346191, 1.44917893409729, 1.5019011497497559, 1.5026631355285645, 1.536693811416626, 1.5776424407958984, 1.7440404891967773, 1.7554643154144287, 1.8193717002868652, 1.8739347457885742, 1.8923091888427734, 1.9191367626190186, 2.025799512863159, 2.0312323570251465, 2.1148691177368164, 2.1568048000335693, 2.1850883960723877, 2.3456192016601562, 2.354602336883545, 2.37970232963562, 2.4112517833709717, 2.4328877925872803, 2.460057258605957, 2.478804349899292, 2.480865955352783, 2.6408183574676514, 2.6455929279327393, 2.799551486968994, 2.8093526363372803, 3.1181933879852295, 3.3101422786712646, 3.4270083904266357, 3.5071282386779785, 3.9443371295928955, 3.988847017288208, 4.019992351531982, 4.361297845840454, 4.806903600692749, 4.865342855453491, 4.919562101364136, 5.0259294509887695, 6.435408592224121], 'PopItemTxParams': [0.07027387619018555, 0.07227921485900879, 0.10079360008239746, 0.10668158531188965, 0.11850214004516602, 0.12570619583129883, 0.1361534595489502, 0.254863977432251, 0.27701544761657715, 0.44822192192077637, 0.5100481510162354, 0.5320830345153809, 0.5471949577331543, 0.5622000694274902, 0.6404983997344971, 0.669607400894165, 0.6966457366943359, 0.7356553077697754, 0.7437050342559814, 0.746955394744873, 0.7939858436584473, 0.8906877040863037], 'TopBalanceTxParams': [0.00359344482421875, 0.003726482391357422, 0.003965616226196289, 0.004187822341918945, 0.00420832633972168, 0.0048465728759765625, 0.004969596862792969, 0.005423307418823242, 0.005464315414428711, 0.0057790279388427734, 0.00588536262512207, 0.005976200103759766, 0.0065288543701171875, 0.0067234039306640625, 0.006776332855224609, 0.006999492645263672, 0.007451295852661133, 0.007950782775878906, 0.00859212875366211, 0.008768081665039062, 0.008771896362304688, 0.008976221084594727, 0.009114742279052734, 0.009310483932495117, 0.011013984680175781, 0.022577524185180664, 0.03266501426696777], 'OrderStatusTxParams': [0.01051187515258789, 0.015633583068847656, 0.017817258834838867, 0.01939105987548828, 0.020412683486938477, 0.02044224739074707, 0.021689891815185547, 0.02239203453063965, 0.02344346046447754, 0.02840399742126465, 0.03365659713745117, 0.0398714542388916, 0.04118013381958008, 0.04542660713195801, 0.04741692543029785, 0.04788327217102051, 0.04807758331298828, 0.04869532585144043, 0.050444602966308594, 0.0637199878692627, 0.06986117362976074, 0.07670855522155762, 0.1237795352935791], 'RelCustomerTxParams': [4.729060649871826, 5.2540764808654785, 6.574305772781372, 14.233669996261597, 15.805685043334961, 29.904192209243774, 30.03121852874756], 'StockLevelTxParams': [0.03783607482910156, 0.062441349029541016, 0.07904767990112305, 0.08771777153015137, 0.09331560134887695, 0.10180377960205078, 0.1510469913482666, 0.17403125762939453, 0.1949317455291748, 0.19643068313598633, 0.2122025489807129, 0.2180016040802002, 0.22145318984985352, 0.47180938720703125]}
INFO:__main__:============================ total time used: 388.9580717086792 second =====================
