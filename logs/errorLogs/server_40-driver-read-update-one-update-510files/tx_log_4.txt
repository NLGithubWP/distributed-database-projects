ERROR:__main__:Errored: 1 retry happened in running tx: DeliveryTxParams-update1, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=388d03a4 key=/Table/58/2/6/1/2289 pri=0.02192394 epo=0 ts=1635832165.528074755,0 min=1635832165.528074755,0 seq=157} lock=true stat=PENDING rts=1635832165.528074755,0 wto=false gul=1635832166.028074755,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 64, in run_tx
    res = operation(m_conn)
  File "cockroachDB_driver.py", line 188, in <lambda>
    l_conn, w_id, carrier_id, id_tuples))
  File "/home/stuproj/cs4224p/temp/tasks/txs/tx_workloadA.py", line 335, in delivery_update_transaction1
    m_conn.commit()
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=388d03a4 key=/Table/58/2/6/1/2289 pri=0.02192394 epo=0 ts=1635832165.528074755,0 min=1635832165.528074755,0 seq=157} lock=true stat=PENDING rts=1635832165.528074755,0 wto=false gul=1635832166.028074755,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn

 ]
INFO:__main__:Running Tx DeliveryTxParams-update1 successful at the 2 time retry
INFO:__main__:============================ read file 4.txt, now total_tx_num reaches 100, write log to logs/tx_log_4.txt =====================
INFO:__main__:============================ read file 4.txt, now total_tx_num reaches 200, write log to logs/tx_log_4.txt =====================
INFO:__main__:============================ read file 4.txt, now total_tx_num reaches 300, write log to logs/tx_log_4.txt =====================
INFO:__main__:============================ read file 4.txt, now total_tx_num reaches 400, write log to logs/tx_log_4.txt =====================
INFO:__main__:============================ read file 4.txt, now total_tx_num reaches 500, write log to logs/tx_log_4.txt =====================
INFO:__main__:============================ using file /home/stuproj/cs4224p/temp/tasks/project_files_4/xact_files_A/4.txt=====================
INFO:__main__:connect to postgresql://naili:@xcnd59:27257/cs5424db, Read file /home/stuproj/cs4224p/temp/tasks/project_files_4/xact_files_A/4.txt and run workload A
INFO:__main__:=======> required_tx_types is: 
INFO:__main__:{'NewOrderTxParams': 212, 'DeliveryTxParams': 112, 'TopBalanceTxParams': 22, 'PaymentTxParams': 93, 'RelCustomerTxParams': 9, 'PopItemTxParams': 16, 'OrderStatusTxParams': 24, 'StockLevelTxParams': 23}
INFO:__main__:=======> succeed_tx_types is: 
INFO:__main__:{'NewOrderTxParams': 212, 'DeliveryTxParams': 112, 'TopBalanceTxParams': 22, 'PaymentTxParams': 93, 'RelCustomerTxParams': 9, 'PopItemTxParams': 16, 'OrderStatusTxParams': 24, 'StockLevelTxParams': 23}
INFO:__main__:=======> tx num percentages is: 
INFO:__main__:{'NewOrderTxParams': '41.48%', 'DeliveryTxParams': '21.91%', 'TopBalanceTxParams': '4.305%', 'PaymentTxParams': '18.19%', 'RelCustomerTxParams': '1.761%', 'PopItemTxParams': '3.131%', 'OrderStatusTxParams': '4.696%', 'StockLevelTxParams': '4.500%'}
INFO:__main__:=======> tx_time_range [min-max] is : 
INFO:__main__:{'NewOrderTxParams': [0.016471385955810547, 9.891099691390991], 'DeliveryTxParams': [0.08910775184631348, 4.38240909576416], 'TopBalanceTxParams': [0.0033011436462402344, 0.0658578872680664], 'PaymentTxParams': [0.00837564468383789, 3.3905715942382812], 'RelCustomerTxParams': [4.570646286010742, 28.821449279785156], 'PopItemTxParams': [0.09554600715637207, 0.9685635566711426], 'OrderStatusTxParams': [0.010568618774414062, 0.24369478225708008], 'StockLevelTxParams': [0.025491714477539062, 0.22938966751098633]}
INFO:__main__:=======> tx_time middle time is : 
INFO:__main__:{'NewOrderTxParams': 0.30925655364990234, 'DeliveryTxParams': 0.37585878372192383, 'TopBalanceTxParams': 0.005813121795654297, 'PaymentTxParams': 0.030620098114013672, 'RelCustomerTxParams': 20.89351201057434, 'PopItemTxParams': 0.4418213367462158, 'OrderStatusTxParams': 0.027688026428222656, 'StockLevelTxParams': 0.1017601490020752}
INFO:__main__:=======> tx_time average time is : 
INFO:__main__:{'NewOrderTxParams': 1.2383394263825327, 'DeliveryTxParams': 0.459929142679487, 'TopBalanceTxParams': 0.015605503862554377, 'PaymentTxParams': 0.131160548938218, 'RelCustomerTxParams': 18.888077285554672, 'PopItemTxParams': 0.4347876012325287, 'OrderStatusTxParams': 0.040312618017196655, 'StockLevelTxParams': 0.10483454621356467}
INFO:__main__:=======> tx time percentage is : 
INFO:__main__:{'NewOrderTxParams': '51.71%', 'DeliveryTxParams': '10.14%', 'TopBalanceTxParams': '0.067%', 'PaymentTxParams': '2.403%', 'RelCustomerTxParams': '33.48%', 'PopItemTxParams': '1.370%', 'OrderStatusTxParams': '0.190%', 'StockLevelTxParams': '0.475%'}
INFO:__main__:============> full tx time used 
INFO:__main__:{'NewOrderTxParams': [0.016471385955810547, 0.01736593246459961, 0.017616987228393555, 0.02013993263244629, 0.020570755004882812, 0.02106332778930664, 0.022072315216064453, 0.023862361907958984, 0.023952245712280273, 0.025310993194580078, 0.025507211685180664, 0.027250051498413086, 0.030060529708862305, 0.030843019485473633, 0.03133869171142578, 0.031813621520996094, 0.034369468688964844, 0.03477764129638672, 0.03505682945251465, 0.035590171813964844, 0.036383628845214844, 0.03730940818786621, 0.03800153732299805, 0.03936886787414551, 0.03986859321594238, 0.04643988609313965, 0.0535585880279541, 0.060469627380371094, 0.06153678894042969, 0.07548117637634277, 0.07753920555114746, 0.08879828453063965, 0.09011268615722656, 0.09021759033203125, 0.09248995780944824, 0.10195708274841309, 0.10258769989013672, 0.10450935363769531, 0.1063847541809082, 0.11183619499206543, 0.11377525329589844, 0.11378693580627441, 0.11806821823120117, 0.12061429023742676, 0.12437057495117188, 0.12874245643615723, 0.1295766830444336, 0.12997031211853027, 0.1396653652191162, 0.14194107055664062, 0.14331293106079102, 0.14564085006713867, 0.14567041397094727, 0.14678001403808594, 0.1476736068725586, 0.1491389274597168, 0.15390539169311523, 0.1586301326751709, 0.16033697128295898, 0.1615276336669922, 0.16330623626708984, 0.17096900939941406, 0.17679595947265625, 0.17910552024841309, 0.18123817443847656, 0.18642401695251465, 0.18718385696411133, 0.18962788581848145, 0.1946702003479004, 0.2000446319580078, 0.20042109489440918, 0.20335984230041504, 0.206712007522583, 0.2072749137878418, 0.20913076400756836, 0.2094733715057373, 0.20978903770446777, 0.2124643325805664, 0.21943879127502441, 0.2198634147644043, 0.22552490234375, 0.22625350952148438, 0.22629690170288086, 0.22919750213623047, 0.22943830490112305, 0.2336122989654541, 0.2378547191619873, 0.2661707401275635, 0.26939964294433594, 0.27100467681884766, 0.27526307106018066, 0.2762877941131592, 0.285538911819458, 0.2875540256500244, 0.2878994941711426, 0.2942845821380615, 0.29646801948547363, 0.2973816394805908, 0.30179405212402344, 0.30320215225219727, 0.30338382720947266, 0.3054814338684082, 0.3056905269622803, 0.3065798282623291, 0.30734896659851074, 0.30753540992736816, 0.30925655364990234, 0.3099064826965332, 0.3150153160095215, 0.32403111457824707, 0.32890915870666504, 0.3296997547149658, 0.3319120407104492, 0.33992934226989746, 0.3478527069091797, 0.35103297233581543, 0.35316014289855957, 0.356752872467041, 0.3586444854736328, 0.3661651611328125, 0.36725544929504395, 0.3685312271118164, 0.3715658187866211, 0.37504124641418457, 0.38084959983825684, 0.383228063583374, 0.38347673416137695, 0.39078664779663086, 0.39949679374694824, 0.4015958309173584, 0.40343785285949707, 0.4449279308319092, 0.44555163383483887, 0.45482587814331055, 0.45764780044555664, 0.4596598148345947, 0.4666123390197754, 0.47200465202331543, 0.4781224727630615, 0.5001509189605713, 0.5076034069061279, 0.528193473815918, 0.538844108581543, 0.5408725738525391, 0.5452873706817627, 0.5461766719818115, 0.5520315170288086, 0.5541043281555176, 0.5544734001159668, 0.5640716552734375, 0.6133899688720703, 0.6218187808990479, 0.6671936511993408, 0.7033061981201172, 0.7151257991790771, 0.7459218502044678, 0.7464120388031006, 0.756633996963501, 0.8097634315490723, 0.8236668109893799, 0.9902725219726562, 1.0279624462127686, 1.0625674724578857, 1.0939149856567383, 1.14849853515625, 1.1746621131896973, 1.2071011066436768, 1.2533903121948242, 1.5018103122711182, 1.5225272178649902, 1.8079969882965088, 1.814852237701416, 1.9545848369598389, 1.9912488460540771, 2.0828399658203125, 2.1838178634643555, 2.517822742462158, 2.595245599746704, 3.0184404850006104, 3.0381598472595215, 3.0818347930908203, 3.139077663421631, 3.1500980854034424, 3.2686784267425537, 3.9336860179901123, 3.986711263656616, 4.230270862579346, 4.369125127792358, 4.453955411911011, 4.5316078662872314, 4.711516618728638, 4.711949348449707, 5.076606512069702, 5.2326343059539795, 5.273148536682129, 5.445176839828491, 5.696097135543823, 5.7604875564575195, 5.991082429885864, 6.08862042427063, 6.1644580364227295, 6.300920248031616, 6.403583288192749, 6.956985712051392, 7.226166486740112, 7.453108549118042, 7.464856147766113, 8.632933378219604, 8.664198398590088, 8.931689023971558, 9.719197511672974, 9.891099691390991], 'DeliveryTxParams': [0.08910775184631348, 0.09551477432250977, 0.09762740135192871, 0.10045909881591797, 0.10521578788757324, 0.11108279228210449, 0.11211562156677246, 0.11490774154663086, 0.1151585578918457, 0.11750006675720215, 0.11988997459411621, 0.12086129188537598, 0.12433624267578125, 0.12449526786804199, 0.12580108642578125, 0.12623906135559082, 0.12831401824951172, 0.1351165771484375, 0.13556408882141113, 0.13573098182678223, 0.13654875755310059, 0.13750505447387695, 0.14519858360290527, 0.14818668365478516, 0.15346384048461914, 0.17172956466674805, 0.19186854362487793, 0.23410630226135254, 0.2444777488708496, 0.26347970962524414, 0.2780478000640869, 0.2790188789367676, 0.28023648262023926, 0.2880678176879883, 0.2883627414703369, 0.288698673248291, 0.29230833053588867, 0.2949976921081543, 0.2987525463104248, 0.3017880916595459, 0.3064534664154053, 0.31459832191467285, 0.3161005973815918, 0.31674695014953613, 0.3258950710296631, 0.32608652114868164, 0.32668185234069824, 0.3389763832092285, 0.3468306064605713, 0.35431528091430664, 0.35601234436035156, 0.36336565017700195, 0.364931583404541, 0.37082648277282715, 0.37507081031799316, 0.37539172172546387, 0.37585878372192383, 0.3763456344604492, 0.3849301338195801, 0.39122462272644043, 0.39148569107055664, 0.39864063262939453, 0.40094614028930664, 0.41092658042907715, 0.4122612476348877, 0.4154551029205322, 0.41696929931640625, 0.418316125869751, 0.4244096279144287, 0.4297966957092285, 0.4305598735809326, 0.4320716857910156, 0.4417729377746582, 0.4432206153869629, 0.4498567581176758, 0.45427703857421875, 0.4565579891204834, 0.4598236083984375, 0.46175456047058105, 0.46404027938842773, 0.46628642082214355, 0.46651363372802734, 0.46680712699890137, 0.46763014793395996, 0.4744691848754883, 0.4785749912261963, 0.4822831153869629, 0.49629878997802734, 0.5034091472625732, 0.5158281326293945, 0.5364236831665039, 0.5529553890228271, 0.5538797378540039, 0.5730950832366943, 0.5910866260528564, 0.6032559871673584, 0.6236872673034668, 0.6310217380523682, 0.6438932418823242, 0.6564009189605713, 0.696582555770874, 0.7087726593017578, 0.7353456020355225, 0.7448153495788574, 0.7931499481201172, 0.8572583198547363, 1.0051836967468262, 1.2232506275177002, 1.318282127380371, 1.550412654876709, 4.041133642196655, 4.38240909576416], 'TopBalanceTxParams': [0.0033011436462402344, 0.0034017562866210938, 0.003455638885498047, 0.0036318302154541016, 0.003785371780395508, 0.004123687744140625, 0.004171133041381836, 0.004330635070800781, 0.004536628723144531, 0.004815101623535156, 0.005006074905395508, 0.005813121795654297, 0.007256031036376953, 0.010009288787841797, 0.010763883590698242, 0.012732744216918945, 0.013117790222167969, 0.014245986938476562, 0.03524518013000488, 0.0602869987487793, 0.06343317031860352, 0.0658578872680664], 'PaymentTxParams': [0.00837564468383789, 0.008491039276123047, 0.009119987487792969, 0.009125471115112305, 0.009134292602539062, 0.009139299392700195, 0.009186983108520508, 0.009268999099731445, 0.009315252304077148, 0.009400367736816406, 0.009659051895141602, 0.009799003601074219, 0.01012110710144043, 0.011008977890014648, 0.011102676391601562, 0.01152658462524414, 0.012338876724243164, 0.012471914291381836, 0.013466119766235352, 0.013506174087524414, 0.01367950439453125, 0.015663623809814453, 0.01589512825012207, 0.01641106605529785, 0.0175323486328125, 0.01858353614807129, 0.018822431564331055, 0.018987178802490234, 0.019021272659301758, 0.01906728744506836, 0.019501209259033203, 0.0196683406829834, 0.01981210708618164, 0.020986557006835938, 0.02226853370666504, 0.02245807647705078, 0.022551536560058594, 0.022737741470336914, 0.023897409439086914, 0.024119853973388672, 0.024181127548217773, 0.024761199951171875, 0.0250399112701416, 0.025205135345458984, 0.026697874069213867, 0.027712583541870117, 0.030620098114013672, 0.031127214431762695, 0.03273177146911621, 0.033051252365112305, 0.033770084381103516, 0.033908843994140625, 0.034040212631225586, 0.03463554382324219, 0.03464794158935547, 0.03524494171142578, 0.03588056564331055, 0.036141395568847656, 0.03850197792053223, 0.04010820388793945, 0.040344953536987305, 0.04218292236328125, 0.04538297653198242, 0.047522544860839844, 0.04756426811218262, 0.049761295318603516, 0.05349445343017578, 0.054807424545288086, 0.05495738983154297, 0.056046247482299805, 0.056670427322387695, 0.05668783187866211, 0.05954790115356445, 0.0595853328704834, 0.06417298316955566, 0.06844925880432129, 0.07040023803710938, 0.07288599014282227, 0.07711625099182129, 0.08260083198547363, 0.08441996574401855, 0.08856034278869629, 0.08959317207336426, 0.10782027244567871, 0.22550344467163086, 0.229140043258667, 0.44994521141052246, 0.5476202964782715, 0.6068089008331299, 0.630972146987915, 1.2904462814331055, 2.06111741065979, 3.3905715942382812], 'RelCustomerTxParams': [4.570646286010742, 8.53507685661316, 13.150583267211914, 13.827678203582764, 20.89351201057434, 26.371230125427246, 26.502747058868408, 27.319772481918335, 28.821449279785156], 'PopItemTxParams': [0.09554600715637207, 0.1137244701385498, 0.11407852172851562, 0.13165688514709473, 0.13224506378173828, 0.19270706176757812, 0.24506115913391113, 0.4192619323730469, 0.4418213367462158, 0.5026352405548096, 0.5453627109527588, 0.5892496109008789, 0.7337164878845215, 0.846071720123291, 0.8848998546600342, 0.9685635566711426], 'OrderStatusTxParams': [0.010568618774414062, 0.011138916015625, 0.011982440948486328, 0.012405872344970703, 0.014290094375610352, 0.014585733413696289, 0.014950990676879883, 0.01566028594970703, 0.016298532485961914, 0.025316476821899414, 0.025457382202148438, 0.025681734085083008, 0.027688026428222656, 0.027707576751708984, 0.029924869537353516, 0.032706499099731445, 0.032869815826416016, 0.03427386283874512, 0.034392595291137695, 0.045361995697021484, 0.04772019386291504, 0.04891848564147949, 0.16390705108642578, 0.24369478225708008], 'StockLevelTxParams': [0.025491714477539062, 0.027446269989013672, 0.032541751861572266, 0.04606151580810547, 0.05191493034362793, 0.06259942054748535, 0.06293606758117676, 0.06332731246948242, 0.07588911056518555, 0.08356523513793945, 0.0975804328918457, 0.1017601490020752, 0.10489749908447266, 0.10863089561462402, 0.1094508171081543, 0.12668347358703613, 0.14352750778198242, 0.1484220027923584, 0.1677112579345703, 0.170820951461792, 0.17529034614562988, 0.19525623321533203, 0.22938966751098633]}
INFO:__main__:============================ total time used: 507.6122786998749 second =====================
