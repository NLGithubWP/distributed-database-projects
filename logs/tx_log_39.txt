ERROR:__main__:Errored: 1 retry happened in running tx: NewOrderTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=4868ece1 key=/Table/56/1/5/6 pri=0.00130669 epo=0 ts=1635832165.615855764,0 min=1635832165.615855764,0 seq=69} lock=true stat=PENDING rts=1635832165.615855764,0 wto=false gul=1635832166.115855764,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 64, in run_tx
    res = operation(m_conn)
  File "cockroachDB_driver.py", line 104, in <lambda>
    lambda l_conn: m_tx_ins.new_order_transaction(l_conn, m_params))
  File "/home/stuproj/cs4224p/temp/tasks/txs/tx_workloadA.py", line 163, in new_order_transaction
    m_conn.commit()
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN): "sql txn" meta={id=4868ece1 key=/Table/56/1/5/6 pri=0.00130669 epo=0 ts=1635832165.615855764,0 min=1635832165.615855764,0 seq=69} lock=true stat=PENDING rts=1635832165.615855764,0 wto=false gul=1635832166.115855764,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_new_lease_prevents_txn

 ]
INFO:__main__:Running Tx NewOrderTxParams successful at the 2 time retry
INFO:__main__:============================ read file 39.txt, now total_tx_num reaches 100, write log to logs/tx_log_39.txt =====================
INFO:__main__:============================ read file 39.txt, now total_tx_num reaches 200, write log to logs/tx_log_39.txt =====================
INFO:__main__:============================ read file 39.txt, now total_tx_num reaches 300, write log to logs/tx_log_39.txt =====================
INFO:__main__:============================ read file 39.txt, now total_tx_num reaches 400, write log to logs/tx_log_39.txt =====================
INFO:__main__:============================ read file 39.txt, now total_tx_num reaches 500, write log to logs/tx_log_39.txt =====================
INFO:__main__:============================ using file /home/stuproj/cs4224p/temp/tasks/project_files_4/xact_files_A/39.txt=====================
INFO:__main__:connect to postgresql://naili:@xcnd59:27257/cs5424db, Read file /home/stuproj/cs4224p/temp/tasks/project_files_4/xact_files_A/39.txt and run workload A
INFO:__main__:=======> required_tx_types is: 
INFO:__main__:{'NewOrderTxParams': 208, 'TopBalanceTxParams': 36, 'DeliveryTxParams': 112, 'PaymentTxParams': 97, 'StockLevelTxParams': 18, 'PopItemTxParams': 14, 'OrderStatusTxParams': 17, 'RelCustomerTxParams': 9}
INFO:__main__:=======> succeed_tx_types is: 
INFO:__main__:{'NewOrderTxParams': 208, 'TopBalanceTxParams': 36, 'DeliveryTxParams': 112, 'PaymentTxParams': 97, 'StockLevelTxParams': 18, 'PopItemTxParams': 14, 'OrderStatusTxParams': 17, 'RelCustomerTxParams': 9}
INFO:__main__:=======> tx num percentages is: 
INFO:__main__:{'NewOrderTxParams': '40.70%', 'TopBalanceTxParams': '7.045%', 'DeliveryTxParams': '21.91%', 'PaymentTxParams': '18.98%', 'StockLevelTxParams': '3.522%', 'PopItemTxParams': '2.739%', 'OrderStatusTxParams': '3.326%', 'RelCustomerTxParams': '1.761%'}
INFO:__main__:=======> tx_time_range [min-max] is : 
INFO:__main__:{'NewOrderTxParams': [0.05198407173156738, 6.8222551345825195], 'TopBalanceTxParams': [0.002806425094604492, 0.050679922103881836], 'DeliveryTxParams': [0.07455778121948242, 5.209526538848877], 'PaymentTxParams': [0.008325338363647461, 4.173302888870239], 'StockLevelTxParams': [0.03255581855773926, 0.25218915939331055], 'PopItemTxParams': [0.07427644729614258, 0.8455169200897217], 'OrderStatusTxParams': [0.01116037368774414, 0.20045948028564453], 'RelCustomerTxParams': [6.352395296096802, 30.959783792495728]}
INFO:__main__:=======> tx_time middle time is : 
INFO:__main__:{'NewOrderTxParams': 0.2629845142364502, 'TopBalanceTxParams': 0.004091024398803711, 'DeliveryTxParams': 0.38832783699035645, 'PaymentTxParams': 0.03946995735168457, 'StockLevelTxParams': 0.14047813415527344, 'PopItemTxParams': 0.580761194229126, 'OrderStatusTxParams': 0.022129058837890625, 'RelCustomerTxParams': 12.734939813613892}
INFO:__main__:=======> tx_time average time is : 
INFO:__main__:{'NewOrderTxParams': 1.099305938069637, 'TopBalanceTxParams': 0.009300947189331055, 'DeliveryTxParams': 0.40540461242198944, 'PaymentTxParams': 0.10075147618952486, 'StockLevelTxParams': 0.13824481434292263, 'PopItemTxParams': 0.4755680901663644, 'OrderStatusTxParams': 0.03453239272622501, 'RelCustomerTxParams': 16.798708730273777}
INFO:__main__:=======> tx time percentage is : 
INFO:__main__:{'NewOrderTxParams': '51.31%', 'TopBalanceTxParams': '0.075%', 'DeliveryTxParams': '10.18%', 'PaymentTxParams': '2.193%', 'StockLevelTxParams': '0.558%', 'PopItemTxParams': '1.494%', 'OrderStatusTxParams': '0.131%', 'RelCustomerTxParams': '33.92%'}
INFO:__main__:============> full tx time used 
INFO:__main__:{'NewOrderTxParams': [0.05198407173156738, 0.05520462989807129, 0.06314349174499512, 0.06637263298034668, 0.07184886932373047, 0.0740361213684082, 0.0755918025970459, 0.07829713821411133, 0.07914948463439941, 0.07995390892028809, 0.08013558387756348, 0.08059477806091309, 0.08582687377929688, 0.08940768241882324, 0.09103727340698242, 0.09331250190734863, 0.09562301635742188, 0.09706544876098633, 0.09885668754577637, 0.09919381141662598, 0.10343217849731445, 0.10556840896606445, 0.1058492660522461, 0.10586905479431152, 0.1060173511505127, 0.10713362693786621, 0.10990786552429199, 0.1100010871887207, 0.11021614074707031, 0.11126446723937988, 0.11219549179077148, 0.11231446266174316, 0.11379599571228027, 0.11579060554504395, 0.11661267280578613, 0.11795258522033691, 0.11856818199157715, 0.11859011650085449, 0.12125277519226074, 0.1220707893371582, 0.1224205493927002, 0.12265515327453613, 0.12321114540100098, 0.12491035461425781, 0.12594246864318848, 0.12627100944519043, 0.12637782096862793, 0.12751293182373047, 0.12891936302185059, 0.1301565170288086, 0.13027429580688477, 0.130523681640625, 0.13261628150939941, 0.1334843635559082, 0.1347208023071289, 0.13539361953735352, 0.13570690155029297, 0.13620352745056152, 0.13880109786987305, 0.13910579681396484, 0.14055252075195312, 0.14220356941223145, 0.1443321704864502, 0.1450953483581543, 0.14584875106811523, 0.14749646186828613, 0.14784789085388184, 0.14786171913146973, 0.15031218528747559, 0.15032696723937988, 0.1520373821258545, 0.15282464027404785, 0.15311884880065918, 0.15599393844604492, 0.15857195854187012, 0.15872883796691895, 0.16173577308654785, 0.16514253616333008, 0.17252564430236816, 0.17499876022338867, 0.1791856288909912, 0.17977595329284668, 0.18218350410461426, 0.18455100059509277, 0.18976259231567383, 0.19157862663269043, 0.19642376899719238, 0.19904780387878418, 0.20181560516357422, 0.20661616325378418, 0.2081313133239746, 0.21037697792053223, 0.2163841724395752, 0.2187643051147461, 0.22032952308654785, 0.2226734161376953, 0.22600698471069336, 0.23273944854736328, 0.23288726806640625, 0.24285197257995605, 0.2435898780822754, 0.24469757080078125, 0.24640750885009766, 0.2477400302886963, 0.2629845142364502, 0.26469898223876953, 0.2771878242492676, 0.28119874000549316, 0.28197264671325684, 0.28642892837524414, 0.2913663387298584, 0.2937436103820801, 0.29889512062072754, 0.32538747787475586, 0.4071822166442871, 0.42774152755737305, 0.6553323268890381, 0.7255165576934814, 0.8303639888763428, 0.941765546798706, 1.0071372985839844, 1.042689323425293, 1.0603818893432617, 1.1665196418762207, 1.1736876964569092, 1.1826424598693848, 1.2003333568572998, 1.222625732421875, 1.241410732269287, 1.2847974300384521, 1.338458776473999, 1.341874361038208, 1.3532395362854004, 1.3574180603027344, 1.4281718730926514, 1.451864242553711, 1.4791169166564941, 1.4796102046966553, 1.5152153968811035, 1.5571792125701904, 1.5575487613677979, 1.5748317241668701, 1.614253044128418, 1.6489546298980713, 1.663259506225586, 1.7339706420898438, 1.769362449645996, 1.7726356983184814, 1.7815823554992676, 1.794363260269165, 1.9415910243988037, 1.9451329708099365, 1.968576192855835, 1.9805028438568115, 2.0081303119659424, 2.012699604034424, 2.054226875305176, 2.0652670860290527, 2.1577601432800293, 2.165771961212158, 2.166508436203003, 2.2092061042785645, 2.219398260116577, 2.268494129180908, 2.2748496532440186, 2.2761712074279785, 2.2931859493255615, 2.2987406253814697, 2.316535711288452, 2.326495885848999, 2.3607583045959473, 2.4012451171875, 2.4028608798980713, 2.422372579574585, 2.4427223205566406, 2.472583055496216, 2.4763269424438477, 2.4937615394592285, 2.4988226890563965, 2.587923288345337, 2.601928472518921, 2.6070215702056885, 2.6124393939971924, 2.6243679523468018, 2.7576510906219482, 2.8057634830474854, 2.819761276245117, 2.9071857929229736, 2.967149019241333, 3.0124475955963135, 3.0239737033843994, 3.0408647060394287, 3.1240761280059814, 3.1275947093963623, 3.1812760829925537, 3.271860361099243, 3.364887237548828, 3.38750958442688, 3.4887773990631104, 3.5356361865997314, 3.692864418029785, 3.8016154766082764, 3.9528095722198486, 4.088444471359253, 4.582438707351685, 4.748619079589844, 4.900568723678589, 6.8222551345825195], 'TopBalanceTxParams': [0.002806425094604492, 0.00316619873046875, 0.0031998157501220703, 0.0032987594604492188, 0.0033843517303466797, 0.0033948421478271484, 0.0034105777740478516, 0.0036487579345703125, 0.0037178993225097656, 0.0037534236907958984, 0.0037980079650878906, 0.003892183303833008, 0.003894329071044922, 0.003912687301635742, 0.003923177719116211, 0.003966569900512695, 0.003968000411987305, 0.003984212875366211, 0.004091024398803711, 0.00414586067199707, 0.004164457321166992, 0.004209995269775391, 0.0043315887451171875, 0.004393577575683594, 0.004547595977783203, 0.004601716995239258, 0.004666566848754883, 0.00645136833190918, 0.007257699966430664, 0.008686065673828125, 0.018231630325317383, 0.02695608139038086, 0.032155752182006836, 0.03505206108093262, 0.04509091377258301, 0.050679922103881836], 'DeliveryTxParams': [0.07455778121948242, 0.07497644424438477, 0.0764777660369873, 0.07962656021118164, 0.08194971084594727, 0.0847630500793457, 0.09119105339050293, 0.09182333946228027, 0.09353303909301758, 0.09649276733398438, 0.10352206230163574, 0.10686755180358887, 0.10872530937194824, 0.11002612113952637, 0.11124396324157715, 0.11253190040588379, 0.11257100105285645, 0.11283612251281738, 0.12031388282775879, 0.12653279304504395, 0.1269237995147705, 0.1328263282775879, 0.1404402256011963, 0.14222931861877441, 0.14337491989135742, 0.14354896545410156, 0.14539599418640137, 0.14569759368896484, 0.14606070518493652, 0.15006494522094727, 0.1533033847808838, 0.15970182418823242, 0.1999506950378418, 0.22818875312805176, 0.23386263847351074, 0.2553374767303467, 0.25935935974121094, 0.2833538055419922, 0.2896156311035156, 0.29077863693237305, 0.2939598560333252, 0.303189754486084, 0.30788612365722656, 0.3369770050048828, 0.3392677307128906, 0.3458263874053955, 0.35039639472961426, 0.36275529861450195, 0.36530423164367676, 0.3680729866027832, 0.37205958366394043, 0.376284122467041, 0.37849950790405273, 0.3838798999786377, 0.3850705623626709, 0.3880434036254883, 0.38832783699035645, 0.3923172950744629, 0.39257311820983887, 0.39369726181030273, 0.39954304695129395, 0.40288329124450684, 0.40592002868652344, 0.4136230945587158, 0.4141504764556885, 0.41625428199768066, 0.4163053035736084, 0.41954565048217773, 0.4203484058380127, 0.4214041233062744, 0.4225485324859619, 0.42292284965515137, 0.42570018768310547, 0.43323636054992676, 0.4361433982849121, 0.4362223148345947, 0.4383559226989746, 0.4428684711456299, 0.4437124729156494, 0.44542860984802246, 0.44766926765441895, 0.45083069801330566, 0.45084309577941895, 0.45281004905700684, 0.4555501937866211, 0.45969128608703613, 0.46346354484558105, 0.48253321647644043, 0.4867391586303711, 0.4945995807647705, 0.49564290046691895, 0.49791717529296875, 0.5028128623962402, 0.5055067539215088, 0.5165877342224121, 0.5245065689086914, 0.5281245708465576, 0.5316300392150879, 0.5418729782104492, 0.5796694755554199, 0.623361349105835, 0.6240236759185791, 0.6405272483825684, 0.6900036334991455, 0.692913293838501, 0.7072899341583252, 0.8098351955413818, 0.8572077751159668, 0.8602492809295654, 1.0407466888427734, 1.3385484218597412, 5.209526538848877], 'PaymentTxParams': [0.008325338363647461, 0.009076595306396484, 0.010213613510131836, 0.010824918746948242, 0.010907173156738281, 0.011201858520507812, 0.011299610137939453, 0.011530160903930664, 0.011615276336669922, 0.012156009674072266, 0.012300729751586914, 0.013213634490966797, 0.013958454132080078, 0.013996124267578125, 0.014542102813720703, 0.014650106430053711, 0.015348196029663086, 0.01555633544921875, 0.015763044357299805, 0.01586127281188965, 0.0167233943939209, 0.016813993453979492, 0.016826868057250977, 0.017679452896118164, 0.018056392669677734, 0.018446922302246094, 0.019137144088745117, 0.021648645401000977, 0.0221407413482666, 0.0223543643951416, 0.02263474464416504, 0.02333521842956543, 0.023830175399780273, 0.02641773223876953, 0.027816295623779297, 0.028504371643066406, 0.029436826705932617, 0.030469417572021484, 0.030533313751220703, 0.0314943790435791, 0.03278398513793945, 0.033373117446899414, 0.0340275764465332, 0.03479957580566406, 0.03585982322692871, 0.03598213195800781, 0.03815460205078125, 0.03857874870300293, 0.03946995735168457, 0.039942026138305664, 0.04002523422241211, 0.040261030197143555, 0.04140663146972656, 0.041562795639038086, 0.04314160346984863, 0.0436711311340332, 0.04406142234802246, 0.04496598243713379, 0.04599595069885254, 0.047113895416259766, 0.04748797416687012, 0.04837346076965332, 0.04869222640991211, 0.0496823787689209, 0.050373077392578125, 0.05200648307800293, 0.052930593490600586, 0.05391120910644531, 0.0550074577331543, 0.05643129348754883, 0.05705738067626953, 0.05807971954345703, 0.05826830863952637, 0.05888080596923828, 0.059188127517700195, 0.06275272369384766, 0.06637382507324219, 0.06678509712219238, 0.06755471229553223, 0.06849265098571777, 0.06886959075927734, 0.06890296936035156, 0.07725405693054199, 0.07832980155944824, 0.07972049713134766, 0.0825033187866211, 0.09194040298461914, 0.09521341323852539, 0.09697842597961426, 0.10000419616699219, 0.10201621055603027, 0.10427212715148926, 0.1071157455444336, 0.19498109817504883, 0.4160933494567871, 1.1852474212646484, 4.173302888870239], 'StockLevelTxParams': [0.03255581855773926, 0.04661440849304199, 0.0947573184967041, 0.09767889976501465, 0.09804892539978027, 0.13187193870544434, 0.13269257545471191, 0.1347675323486328, 0.14036226272583008, 0.14047813415527344, 0.1430950164794922, 0.15006637573242188, 0.15825366973876953, 0.16221404075622559, 0.16456985473632812, 0.20145702362060547, 0.20673370361328125, 0.25218915939331055], 'PopItemTxParams': [0.07427644729614258, 0.09834456443786621, 0.11059331893920898, 0.1911303997039795, 0.42491769790649414, 0.4463977813720703, 0.49438929557800293, 0.580761194229126, 0.6180806159973145, 0.6315863132476807, 0.655726432800293, 0.7342278957366943, 0.7520043849945068, 0.8455169200897217], 'OrderStatusTxParams': [0.01116037368774414, 0.011614561080932617, 0.01223301887512207, 0.012507915496826172, 0.01345968246459961, 0.014365196228027344, 0.01845860481262207, 0.019666194915771484, 0.022129058837890625, 0.023805856704711914, 0.030971765518188477, 0.03237557411193848, 0.03478240966796875, 0.036716461181640625, 0.04054427146911621, 0.05180025100708008, 0.20045948028564453], 'RelCustomerTxParams': [6.352395296096802, 11.555816650390625, 12.325852155685425, 12.578429698944092, 12.734939813613892, 14.216896057128906, 23.50876474380493, 26.95550036430359, 30.959783792495728]}
INFO:__main__:============================ total time used: 445.60492849349976 second =====================
