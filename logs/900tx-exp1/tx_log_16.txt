INFO:__main__:Running Tx DeliveryTxParams successful at the 4 time retry
ERROR:__main__:Errored: 2 retry happened in running tx: DeliveryTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_ABORT_SPAN): "sql txn" meta={id=ac3f92c6 key=/Table/57/1/"\x84<?#\xbf\x9cH\x00\x82\x1e\x1f\x91\xdf\xce=\x1d"/0 pri=0.02692179 epo=0 ts=1635652209.790909000,1 min=1635652203.555110000,0 seq=28} lock=true stat=ABORTED rts=1635652203.555110000,0 wto=false gul=1635652204.055110000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_abort_span
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 74, in execute_tx
    each_tx_time = tx_ins.delivery_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 268, in delivery_transaction
    cur.execute(query)
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_ABORT_SPAN): "sql txn" meta={id=ac3f92c6 key=/Table/57/1/"\x84<?#\xbf\x9cH\x00\x82\x1e\x1f\x91\xdf\xce=\x1d"/0 pri=0.02692179 epo=0 ts=1635652209.790909000,1 min=1635652203.555110000,0 seq=28} lock=true stat=ABORTED rts=1635652203.555110000,0 wto=false gul=1635652204.055110000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_abort_span

 ]
ERROR:__main__:Errored: 3 retry happened in running tx: DeliveryTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionRetryError: retry txn (RETRY_SERIALIZABLE - failed preemptive refresh): "sql txn" meta={id=b859e278 key=/Table/57/1/"\x84<?#\xbf\x9cH\x00\x82\x1e\x1f\x91\xdf\xce=\x1d"/0 pri=0.00513894 epo=0 ts=1635652225.679563000,2 min=1635652211.960574000,0 seq=149} lock=true stat=PENDING rts=1635652211.960574000,0 wto=false gul=1635652212.460574000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#retry_serializable
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 74, in execute_tx
    each_tx_time = tx_ins.delivery_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 290, in delivery_transaction
    m_conn.commit()
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionRetryError: retry txn (RETRY_SERIALIZABLE - failed preemptive refresh): "sql txn" meta={id=b859e278 key=/Table/57/1/"\x84<?#\xbf\x9cH\x00\x82\x1e\x1f\x91\xdf\xce=\x1d"/0 pri=0.00513894 epo=0 ts=1635652225.679563000,2 min=1635652211.960574000,0 seq=149} lock=true stat=PENDING rts=1635652211.960574000,0 wto=false gul=1635652212.460574000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#retry_serializable

 ]
ERROR:__main__:Errored: 4 retry happened in running tx: DeliveryTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionRetryError: retry txn (RETRY_SERIALIZABLE - failed preemptive refresh): "sql txn" meta={id=88f22545 key=/Table/57/1/"\x84<?#\xbf\x9cH\x00\x82\x1e\x1f\x91\xdf\xce=\x1d"/0 pri=0.00238013 epo=1 ts=1635652251.363446000,2 min=1635652229.955500000,0 seq=164} lock=true stat=PENDING rts=1635652237.785395000,2 wto=false gul=1635652230.455500000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#retry_serializable
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 74, in execute_tx
    each_tx_time = tx_ins.delivery_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 290, in delivery_transaction
    m_conn.commit()
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionRetryError: retry txn (RETRY_SERIALIZABLE - failed preemptive refresh): "sql txn" meta={id=88f22545 key=/Table/57/1/"\x84<?#\xbf\x9cH\x00\x82\x1e\x1f\x91\xdf\xce=\x1d"/0 pri=0.00238013 epo=1 ts=1635652251.363446000,2 min=1635652229.955500000,0 seq=164} lock=true stat=PENDING rts=1635652237.785395000,2 wto=false gul=1635652230.455500000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#retry_serializable

 ]
ERROR:__main__:Errored: 5 retry happened in running tx: DeliveryTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_ABORT_SPAN): "sql txn" meta={id=e9321b3b key=/Table/57/1/"\xe5Ig\xa6\u007fPH\x00\xb2\xa4\xb3\xd3?\xa8l\xd1"/0 pri=0.05059238 epo=0 ts=1635652272.003912000,2 min=1635652263.333395000,0 seq=19} lock=true stat=ABORTED rts=1635652263.333395000,0 wto=false gul=1635652263.833395000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_abort_span
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 74, in execute_tx
    each_tx_time = tx_ins.delivery_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 268, in delivery_transaction
    cur.execute(query)
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_ABORT_SPAN): "sql txn" meta={id=e9321b3b key=/Table/57/1/"\xe5Ig\xa6\u007fPH\x00\xb2\xa4\xb3\xd3?\xa8l\xd1"/0 pri=0.05059238 epo=0 ts=1635652272.003912000,2 min=1635652263.333395000,0 seq=19} lock=true stat=ABORTED rts=1635652263.333395000,0 wto=false gul=1635652263.833395000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_abort_span

 ]
ERROR:__main__:Errored: Max Try time reached, tx DeliveryTxParams sill error! 
INFO:__main__:============================ record when total_tx_num reaches 100=====================
ERROR:__main__:Errored: 1 retry happened in running tx: RelCustomerTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: ReadWithinUncertaintyIntervalError: read at time 1635652496.908817000,0 encountered previous write with future timestamp 1635652496.908817000,1 within uncertainty interval `t <= (local=1635652496.911245000,0, global=1635652497.408817000,0)`; observed timestamps: [{2 1635652496.908817000,0} {3 1635652496.911245000,0}]: "sql txn" meta={id=d6d5ed68 pri=0.00695423 epo=0 ts=1635652496.908817000,0 min=1635652496.908817000,0 seq=0} lock=false stat=PENDING rts=1635652496.908817000,0 wto=false gul=1635652497.408817000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#readwithinuncertaintyinterval
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 84, in execute_tx
    each_tx_time = tx_ins.related_customer_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 556, in related_customer_transaction
    ''', (order[0], w_id, d_id, w_id)
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: ReadWithinUncertaintyIntervalError: read at time 1635652496.908817000,0 encountered previous write with future timestamp 1635652496.908817000,1 within uncertainty interval `t <= (local=1635652496.911245000,0, global=1635652497.408817000,0)`; observed timestamps: [{2 1635652496.908817000,0} {3 1635652496.911245000,0}]: "sql txn" meta={id=d6d5ed68 pri=0.00695423 epo=0 ts=1635652496.908817000,0 min=1635652496.908817000,0 seq=0} lock=false stat=PENDING rts=1635652496.908817000,0 wto=false gul=1635652497.408817000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#readwithinuncertaintyinterval

 ]
ERROR:__main__:Errored: 2 retry happened in running tx: RelCustomerTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: ReadWithinUncertaintyIntervalError: read at time 1635652506.163260000,0 encountered previous write with future timestamp 1635652506.163260000,1 within uncertainty interval `t <= (local=1635652506.168989000,0, global=1635652506.663260000,0)`; observed timestamps: [{2 1635652506.163260000,0} {3 1635652506.168989000,0}]: "sql txn" meta={id=b6386e52 pri=0.01818002 epo=0 ts=1635652506.163260000,0 min=1635652506.163260000,0 seq=0} lock=false stat=PENDING rts=1635652506.163260000,0 wto=false gul=1635652506.663260000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#readwithinuncertaintyinterval
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 84, in execute_tx
    each_tx_time = tx_ins.related_customer_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 556, in related_customer_transaction
    ''', (order[0], w_id, d_id, w_id)
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: ReadWithinUncertaintyIntervalError: read at time 1635652506.163260000,0 encountered previous write with future timestamp 1635652506.163260000,1 within uncertainty interval `t <= (local=1635652506.168989000,0, global=1635652506.663260000,0)`; observed timestamps: [{2 1635652506.163260000,0} {3 1635652506.168989000,0}]: "sql txn" meta={id=b6386e52 pri=0.01818002 epo=0 ts=1635652506.163260000,0 min=1635652506.163260000,0 seq=0} lock=false stat=PENDING rts=1635652506.163260000,0 wto=false gul=1635652506.663260000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#readwithinuncertaintyinterval

 ]
INFO:__main__:Running Tx RelCustomerTxParams successful at the 3 time retry
INFO:__main__:============================ record when total_tx_num reaches 200=====================
ERROR:__main__:Errored: 1 retry happened in running tx: NewOrderTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: WriteTooOldError: write at timestamp 1635652787.038067000,0 too old; wrote at 1635652787.038067000,2: "sql txn" meta={id=98b67ddc pri=0.00633420 epo=0 ts=1635652787.038067000,2 min=1635652787.038067000,0 seq=14} lock=true stat=PENDING rts=1635652787.038067000,0 wto=false gul=1635652787.538067000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 70, in execute_tx
    each_tx_time = tx_ins.new_order_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 97, in new_order_transaction
    (adjusted_qty, quantity[i], supplier_warehouse[i], item_number[i]))
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: WriteTooOldError: write at timestamp 1635652787.038067000,0 too old; wrote at 1635652787.038067000,2: "sql txn" meta={id=98b67ddc pri=0.00633420 epo=0 ts=1635652787.038067000,2 min=1635652787.038067000,0 seq=14} lock=true stat=PENDING rts=1635652787.038067000,0 wto=false gul=1635652787.538067000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html

 ]
INFO:__main__:Running Tx NewOrderTxParams successful at the 2 time retry
INFO:__main__:============================ record when total_tx_num reaches 300=====================
INFO:__main__:============================ record when total_tx_num reaches 400=====================
ERROR:__main__:Errored: 1 retry happened in running tx: NewOrderTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=7701f020 key=/Table/55/1/5/1 pri=0.01949808 epo=0 ts=1635653212.291581000,0 min=1635653211.290551000,0 seq=116} lock=true stat=ABORTED rts=1635653211.290551000,0 wto=false gul=1635653211.790551000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 70, in execute_tx
    each_tx_time = tx_ins.new_order_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 132, in new_order_transaction
    cur.execute("SELECT W_TAX FROM warehouse WHERE W_ID = %s", [w_id])
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=7701f020 key=/Table/55/1/5/1 pri=0.01949808 epo=0 ts=1635653212.291581000,0 min=1635653211.290551000,0 seq=116} lock=true stat=ABORTED rts=1635653211.290551000,0 wto=false gul=1635653211.790551000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted

 ]
INFO:__main__:Running Tx NewOrderTxParams successful at the 2 time retry
INFO:__main__:============================ record when total_tx_num reaches 500=====================
INFO:__main__:============================ record when total_tx_num reaches 600=====================
ERROR:__main__:Errored: 1 retry happened in running tx: NewOrderTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=18bf9121 key=/Table/55/1/5/2 pri=0.02154461 epo=0 ts=1635653660.082173000,0 min=1635653658.080118000,0 seq=92} lock=true stat=ABORTED rts=1635653658.080118000,0 wto=false gul=1635653658.580118000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 70, in execute_tx
    each_tx_time = tx_ins.new_order_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 132, in new_order_transaction
    cur.execute("SELECT W_TAX FROM warehouse WHERE W_ID = %s", [w_id])
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=18bf9121 key=/Table/55/1/5/2 pri=0.02154461 epo=0 ts=1635653660.082173000,0 min=1635653658.080118000,0 seq=92} lock=true stat=ABORTED rts=1635653658.080118000,0 wto=false gul=1635653658.580118000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted

 ]
INFO:__main__:Running Tx NewOrderTxParams successful at the 2 time retry
INFO:__main__:============================ record when total_tx_num reaches 700=====================
INFO:__main__:============================ record when total_tx_num reaches 800=====================
ERROR:__main__:Errored: 1 retry happened in running tx: NewOrderTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=c48afce8 key=/Table/55/1/5/1 pri=0.01143799 epo=0 ts=1635654240.352963000,0 min=1635654238.352042000,0 seq=128} lock=true stat=ABORTED rts=1635654238.352042000,0 wto=false gul=1635654238.852042000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 70, in execute_tx
    each_tx_time = tx_ins.new_order_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 132, in new_order_transaction
    cur.execute("SELECT W_TAX FROM warehouse WHERE W_ID = %s", [w_id])
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=c48afce8 key=/Table/55/1/5/1 pri=0.01143799 epo=0 ts=1635654240.352963000,0 min=1635654238.352042000,0 seq=128} lock=true stat=ABORTED rts=1635654238.352042000,0 wto=false gul=1635654238.852042000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted

 ]
ERROR:__main__:Errored: 2 retry happened in running tx: NewOrderTxParams, ErrorMsg: 
[ restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=63f335ed key=/Table/55/1/5/1 pri=0.01143799 epo=0 ts=1635654243.483311000,0 min=1635654241.482156000,0 seq=22} lock=true stat=ABORTED rts=1635654241.482156000,0 wto=false gul=1635654241.982156000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted
 ], Traceback: 
[ Traceback (most recent call last):
  File "cockroachDB_driver.py", line 70, in execute_tx
    each_tx_time = tx_ins.new_order_transaction(m_conn, m_params)
  File "/Users/nailixing/Documents/NUS_Modules/CS5424_Distributed_Database/projects/CS5424/txs/tx_workloadA.py", line 81, in new_order_transaction
    cur.execute(query)
psycopg2.errors.SerializationFailure: restart transaction: TransactionRetryWithProtoRefreshError: TransactionAbortedError(ABORT_REASON_PUSHER_ABORTED): "sql txn" meta={id=63f335ed key=/Table/55/1/5/1 pri=0.01143799 epo=0 ts=1635654243.483311000,0 min=1635654241.482156000,0 seq=22} lock=true stat=ABORTED rts=1635654241.482156000,0 wto=false gul=1635654241.982156000,0
HINT:  See: https://www.cockroachlabs.com/docs/v21.1/transaction-retry-error-reference.html#abort_reason_pusher_aborted

 ]
INFO:__main__:Running Tx NewOrderTxParams successful at the 3 time retry
INFO:__main__:============================ record when total_tx_num reaches 900=====================
INFO:__main__:============================ using file /opt/project_files/xact_files_A/16.txt=====================
INFO:__main__:{'NewOrderTxParams': 875, 'TopBalanceTxParams': 1, 'DeliveryTxParams': 12, 'OrderStatusTxParams': 3, 'PaymentTxParams': 8, 'StockLevelTxParams': 2, 'RelCustomerTxParams': 1}
INFO:__main__:============================ total time used: 2364.823831796646 second =====================
